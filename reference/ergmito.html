<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimation of ERGMs using Maximum Likelihood Estimation (MLE) — vcov.ergmito • ergmito</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimation of ERGMs using Maximum Likelihood Estimation (MLE) — vcov.ergmito" />
<meta property="og:description" content="ergmito uses Maximum Likelihood Estimation (MLE) to fit Exponential Random
Graph Models for single or multiple small networks, the later using
pooled-data MLE. To do so we use exact likelihoods, which implies fully
enumerating the support of the model. Overall, the exact likelihood
calculation is only possible when dealing with directed (undirected) networks
size 5 (7). In general, directed (undirected) graphs with more than 5 (7)
vertices should not be fitted using MLE, but instead other methods such as
the MC-MLE algorithm or the Robbins-Monro Stochastic Approximation algorithm,
both of which are available in the ergm R package.The workhorse function of
ergmito is the ergm package function ergm::ergm.allstats()." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70821549-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70821549-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ergmito</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ergm-equations.html">ERGM equations</a>
    </li>
    <li>
      <a href="../articles/extending-ergmito.html">Extending ergmito</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/muriteams/ergmito/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimation of ERGMs using Maximum Likelihood Estimation (MLE)</h1>
    <small class="dont-index">Source: <a href='https://github.com/muriteams/ergmito/blob/master/R/ergmito-methods.R'><code>R/ergmito-methods.R</code></a>, <a href='https://github.com/muriteams/ergmito/blob/master/R/ergmito.R'><code>R/ergmito.R</code></a></small>
    <div class="hidden name"><code>ergmito.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>ergmito</code> uses Maximum Likelihood Estimation (MLE) to fit Exponential Random
Graph Models for single or multiple small networks, the later using
pooled-data MLE. To do so we use exact likelihoods, which implies fully
enumerating the support of the model. Overall, the exact likelihood
calculation is only possible when dealing with directed (undirected) networks
size 5 (7). In general, directed (undirected) graphs with more than 5 (7)
vertices should not be fitted using MLE, but instead other methods such as
the MC-MLE algorithm or the Robbins-Monro Stochastic Approximation algorithm,
both of which are available in the ergm R package.The workhorse function of
<code>ergmito</code> is the <code>ergm</code> package function <code><a href='https://rdrr.io/pkg/ergm/man/ergm.allstats.html'>ergm::ergm.allstats()</a></code>.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for ergmito</span>
<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>object</span>, <span class='kw'>solver</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='fu'>ergmito</span>(
  <span class='no'>model</span>,
  <span class='kw'>model_update</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>stats_weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>stats_statmat</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>optim.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>init</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>use.grad</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>target_stats</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ntries</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>keep.stats</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>target_offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>stats_offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>ergmito</code></p></td>
    </tr>
    <tr>
      <th>solver</th>
      <td><p>Function. Used to compute the inverse of the hessian matrix. When
not null, the variance-covariance matrix is recomputed using that function.
By default, <code>ergmito</code> uses <a href='https://rdrr.io/pkg/MASS/man/ginv.html'>MASS::ginv</a>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments passed to the method. In the case of <code>ergmito</code>,
<code>...</code> are passed to <a href='ergmito_formulae.html'>ergmito_formulae</a>.</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>Model to estimate. See <a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm::ergm</a>. The only difference with
<code>ergm</code> is that the LHS can be a list of networks.</p></td>
    </tr>
    <tr>
      <th>model_update</th>
      <td><p>A <code><a href='https://rdrr.io/r/stats/formula.html'>formula</a></code>. this can be used to
apply transformations, create interaction effects, add offset terms, etc.
(see examples below and more details in <a href='ergmito_formulae.html'>ergmito_formulae</a>).</p></td>
    </tr>
    <tr>
      <th>stats_weights</th>
      <td><p>Either an integer vector or a list of integer vectors (see <a href='exact_loglik.html'>exact_loglik</a>).</p></td>
    </tr>
    <tr>
      <th>stats_statmat</th>
      <td><p>Either a matrix or a list of matrices (see <a href='exact_loglik.html'>exact_loglik</a>).</p></td>
    </tr>
    <tr>
      <th>optim.args</th>
      <td><p>List. Passed to <a href='https://rdrr.io/r/stats/optim.html'>stats::optim</a>.</p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>A numeric vector. Sets the starting parameters for the
optimization routine. Default is a vector of zeros.</p></td>
    </tr>
    <tr>
      <th>use.grad</th>
      <td><p>Logical. When <code>TRUE</code> passes the gradient function to <code>optim</code>.
This is intended for testing only (internal use).</p></td>
    </tr>
    <tr>
      <th>target_stats</th>
      <td><p>A matrix of target statistics (see <a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm::ergm</a>).</p></td>
    </tr>
    <tr>
      <th>ntries</th>
      <td><p>Integer scalar. Number of tries to estimate the MLE (see details).</p></td>
    </tr>
    <tr>
      <th>keep.stats</th>
      <td><p>Logical scalar. When <code>TRUE</code> (the default), the matrices
and vectors associated with the sufficient statistics will be returned.
Otherwise the function discards them. This may be useful for saving memory
space when estimating multiple models.</p></td>
    </tr>
    <tr>
      <th>target_offset, stats_offset</th>
      <td><p>See <code><a href='exact_loglik.html'>exact_loglik()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An list of class <code>ergmito</code>:</p><ul>
<li><p><code>call</code>          The program call.</p></li>
<li><p><code>coef</code>          Named vector. Parameter estimates.</p></li>
<li><p><code>iterations</code>    Integer. Number of times the log-likelihood was evaluated
(see <a href='https://rdrr.io/r/stats/optim.html'>stats::optim</a>).</p></li>
<li><p><code>mle.lik</code>       Numeric. Final value of the objective function.</p></li>
<li><p><code>null.lik</code>      Numeric. Final value of the objective function for the null model.</p></li>
<li><p><code>covar</code>         Square matrix of size <code><a href='https://rdrr.io/r/base/length.html'>length(coef)</a></code>. Variance-covariance matrix
computed using the exact hessian as implemented in <a href='exact_loglik.html'>exact_hessian</a>.</p></li>
<li><p><code>coef.init</code>     Named vector of length <code><a href='https://rdrr.io/r/base/length.html'>length(coef)</a></code>. Initial set of parameters
used in the optimization.</p></li>
<li><p><code>formulae</code>      An object of class <a href='ergmito_formulae.html'>ergmito_loglik</a>.</p></li>
<li><p><code>nobs</code>          Integer scalar. Number of networks in the model.</p></li>
<li><p><code>network</code>       Networks passed via <code>model</code>.</p></li>
<li><p><code>optim.out</code>,<code>optim.args</code> Results from the optim call and arguments passed to it.</p></li>
<li><p><code>status</code>,<code>note</code> Convergence code. See <a href='check_convergence.html'>check_convergence</a></p></li>
<li><p><code>best_try</code>      Integer scalar. Index of the run with the highest log-likelihood value.</p></li>
<li><p><code>history</code>       Matrix of size <code>ntries * (k + 1)</code>. History of the parameter
estimates and the reached log-likelihood values.</p></li>
<li><p><code>timer</code>         Vector of times (for benchmarking). Each unit marks the starting
point of the step.</p></li>
</ul>

<p>Methods <code><a href='https://rdrr.io/r/base/print.html'>base::print()</a></code>, <code><a href='https://rdrr.io/r/base/summary.html'>base::summary()</a></code>, <code><a href='https://rdrr.io/r/stats/coef.html'>stats::coef()</a></code>, <code><a href='https://rdrr.io/r/stats/logLik.html'>stats::logLik()</a></code>,
<code><a href='https://rdrr.io/r/stats/nobs.html'>stats::nobs()</a></code>, <code><a href='https://rdrr.io/r/stats/vcov.html'>stats::vcov()</a></code>, <code><a href='https://rdrr.io/r/stats/AIC.html'>stats::AIC()</a></code>, <code><a href='https://rdrr.io/r/stats/AIC.html'>stats::BIC()</a></code>,
<code><a href='https://rdrr.io/r/stats/confint.html'>stats::confint()</a></code>, and  <code><a href='https://rdrr.io/r/stats/formula.html'>stats::formula()</a></code> are available.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The support of the sufficient statistics is calculated using ERGM's
<code><a href='https://rdrr.io/pkg/ergm/man/ergm.allstats.html'>ergm::ergm.allstats()</a></code> function.</p>
    <h2 class="hasAnchor" id="mle"><a class="anchor" href="#mle"></a>MLE</h2>

    


<p>Maximum Likelihood Estimates are obtained using the <a href='https://rdrr.io/r/stats/optim.html'>stats::optim</a> function.
The default method for maximization is <code>BFGS</code> using both the log-likelihood
function and its corresponding gradient.</p>
<p>Another important factor to consider is the existence of the MLE estimates
As shown in Handcock (2003), if the observed statistics are near the border
if the support function (e.g. too many edges or almost none), then, even if
the MLE estimates exists, the optimization function may not be able to reach
the optima. Moreover, if the target (observed) statistics live in the boundary,
then the MLE estimates do not exists. In general, this should not be an issue
in the context of the pooled model, as the variability of observed statistics
should be enough to avoid those situations.</p>
<p>The function <code>ergmito</code> will try to identify possible cases of non-existence,
of the MLE, and if identified then try to re estimate the model parameters using
larger values than the ones obtained, if the log-likelihood is greater, then it is
assumed that the model is degenerate and the corresponding values will be
replaced with either <code>+Inf</code> or  <code>-Inf</code>. By default, this behavior is checked
anytime that the absolute value of the estimates is greater than 5, or the
sufficient statistics were flagged as potentially outside of the interior of
the support (close to zero or to its max).</p>
<p>In the case of <code>ntries</code>, the optimization is repeated that number of times,
each time perturbing the <code>init</code> parameter by adding a Normally distributed
vector. The result which reaches the highest log-likelihood will be the one
reported as parameter estimates. This feature is intended for testing only.
Anecdotally, <code>optim</code> reaches the max in the first try.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The function <code><a href='plot.ergmito.html'>plot.ergmito()</a></code> and <code><a href='ergmito_gof.html'>gof_ergmito()</a></code> for post-estimation
diagnostics.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Generating a small graph</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>12</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>4</span>
<span class='no'>net</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rbernoulli.html'>rbernoulli</a></span>(<span class='no'>n</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='fl'>.3</span>)

<span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='no'>net</span> ~ <span class='no'>edges</span> + <span class='no'>mutual</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ergm</span>)
<span class='no'>ans_ergmito</span> <span class='kw'>&lt;-</span> <span class='fu'>ergmito</span>(<span class='no'>model</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: The observed statistics (target.statistics) are near or at the boundary of its support, i.e. the Maximum Likelihood Estimates maynot exist or be hard to be estimated. In particular, the statistic(s) "edges", "mutual".</span></div><div class='input'><span class='no'>ans_ergm</span>  <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.html'>ergm</a></span>(<span class='no'>model</span>)</div><div class='output co'>#&gt; <span class='message'>Starting maximum pseudolikelihood estimation (MPLE):</span></div><div class='output co'>#&gt; <span class='message'>Evaluating the predictor and response matrix.</span></div><div class='output co'>#&gt; <span class='message'>Maximizing the pseudolikelihood.</span></div><div class='output co'>#&gt; <span class='message'>Finished MPLE.</span></div><div class='output co'>#&gt; <span class='message'>Starting Monte Carlo maximum likelihood estimation (MCMLE):</span></div><div class='output co'>#&gt; <span class='message'>Iteration 1 of at most 20:</span></div><div class='output co'>#&gt; <span class='message'>Optimizing with step length 1.</span></div><div class='output co'>#&gt; <span class='message'>The log-likelihood improved by 0.0007299.</span></div><div class='output co'>#&gt; <span class='message'>Step length converged once. Increasing MCMC sample size.</span></div><div class='output co'>#&gt; <span class='message'>Iteration 2 of at most 20:</span></div><div class='output co'>#&gt; <span class='message'>Optimizing with step length 1.</span></div><div class='output co'>#&gt; <span class='message'>The log-likelihood improved by 0.0006848.</span></div><div class='output co'>#&gt; <span class='message'>Step length converged twice. Stopping.</span></div><div class='output co'>#&gt; <span class='message'>Finished MCMLE.</span></div><div class='output co'>#&gt; <span class='message'>Evaluating log-likelihood at the estimate. </span></div><div class='output co'>#&gt; <span class='message'>Using 20 bridges: </span></div><div class='output co'>#&gt; <span class='message'>1 </span></div><div class='output co'>#&gt; <span class='message'>2 </span></div><div class='output co'>#&gt; <span class='message'>3 </span></div><div class='output co'>#&gt; <span class='message'>4 </span></div><div class='output co'>#&gt; <span class='message'>5 </span></div><div class='output co'>#&gt; <span class='message'>6 </span></div><div class='output co'>#&gt; <span class='message'>7 </span></div><div class='output co'>#&gt; <span class='message'>8 </span></div><div class='output co'>#&gt; <span class='message'>9 </span></div><div class='output co'>#&gt; <span class='message'>10 </span></div><div class='output co'>#&gt; <span class='message'>11 </span></div><div class='output co'>#&gt; <span class='message'>12 </span></div><div class='output co'>#&gt; <span class='message'>13 </span></div><div class='output co'>#&gt; <span class='message'>14 </span></div><div class='output co'>#&gt; <span class='message'>15 </span></div><div class='output co'>#&gt; <span class='message'>16 </span></div><div class='output co'>#&gt; <span class='message'>17 </span></div><div class='output co'>#&gt; <span class='message'>18 </span></div><div class='output co'>#&gt; <span class='message'>19 </span></div><div class='output co'>#&gt; <span class='message'>20 </span></div><div class='output co'>#&gt; <span class='message'>.</span></div><div class='output co'>#&gt; <span class='message'>This model was fit using MCMC.  To examine model diagnostics and check</span>
#&gt; <span class='message'>for degeneracy, use the mcmc.diagnostics() function.</span></div><div class='input'>
<span class='co'># The ergmito should have a larger value</span>
<span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.exact.html'>ergm.exact</a></span>(<span class='no'>ans_ergmito</span>$<span class='no'>coef</span>, <span class='no'>model</span>)</div><div class='output co'>#&gt;           [,1]
#&gt; [1,] -7.977968</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm.exact.html'>ergm.exact</a></span>(<span class='no'>ans_ergm</span>$<span class='no'>coef</span>, <span class='no'>model</span>)</div><div class='output co'>#&gt;           [,1]
#&gt; [1,] -7.977994</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/ergm/man/summary.formula.html'>summary</a></span>(<span class='no'>ans_ergmito</span>)</div><div class='output co'>#&gt; 
#&gt; ERGMito estimates (MLE)
#&gt; This model includes 1 networks.
#&gt; 
#&gt; formula:
#&gt;   net ~ edges + mutual
#&gt; &lt;environment: 0x11d8d5a0&gt;
#&gt; 
#&gt;        Estimate Std. Error z value Pr(&gt;|z|)
#&gt; edges   0.69312    1.11802  0.6199   0.5353
#&gt; mutual -1.38627    1.73205 -0.8004   0.4235
#&gt; AIC: 19.95594    BIC: 20.92575    (Smaller is better.) </div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/ergm/man/summary.formula.html'>summary</a></span>(<span class='no'>ans_ergm</span>)</div><div class='output co'>#&gt; 
#&gt; ==========================
#&gt; Summary of model fit
#&gt; ==========================
#&gt; 
#&gt; Formula:   net ~ edges + mutual
#&gt; &lt;environment: 0x11d8d5a0&gt;
#&gt; 
#&gt; Iterations:  2 out of 20 
#&gt; 
#&gt; Monte Carlo MLE Results:
#&gt;        Estimate Std. Error MCMC % z value Pr(&gt;|z|)
#&gt; edges     0.689      1.141      0   0.604    0.546
#&gt; mutual   -1.375      1.750      0  -0.786    0.432
#&gt; 
#&gt;      Null Deviance: 16.64  on 12  degrees of freedom
#&gt;  Residual Deviance: 15.93  on 10  degrees of freedom
#&gt;  
#&gt; AIC: 19.93    BIC: 20.9    (Smaller is better.) </div><div class='input'>
<span class='co'># Example 2: Estimating an ERGMito using data with know DGP parameters -----</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>fivenets</span>)

<span class='no'>model1</span> <span class='kw'>&lt;-</span> <span class='fu'>ergmito</span>(<span class='no'>fivenets</span> ~ <span class='no'>edges</span> + <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm-terms.html'>nodematch</a></span>(<span class='st'>"female"</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: The observed statistics (target.statistics) are near or at the boundary of its support, i.e. the Maximum Likelihood Estimates maynot exist or be hard to be estimated. In particular, the statistic(s) "edges", "nodematch.female".</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/ergm/man/summary.formula.html'>summary</a></span>(<span class='no'>model1</span>) <span class='co'># This data has know parameters equal to -2.0 and 2.0</span></div><div class='output co'>#&gt; 
#&gt; ERGMito estimates (MLE)
#&gt; This model includes 5 networks.
#&gt; 
#&gt; formula:
#&gt;   fivenets ~ edges + nodematch("female")
#&gt; &lt;environment: 0x11d8d5a0&gt;
#&gt; 
#&gt;                  Estimate Std. Error z value Pr(&gt;|z|)   
#&gt; edges            -1.70475    0.54356 -3.1363 0.001711 **
#&gt; nodematch.female  1.58697    0.64305  2.4679 0.013592 * 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; AIC: 73.34109    BIC: 77.52978    (Smaller is better.) </div><div class='input'>
<span class='co'># Example 3: Likelihood ratio test using the lmtest R package</span>

<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>lmtest</span>)) {
  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>fivenets</span>)
  <span class='no'>model1</span> <span class='kw'>&lt;-</span> <span class='fu'>ergmito</span>(<span class='no'>fivenets</span> ~ <span class='no'>edges</span> + <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm-terms.html'>nodematch</a></span>(<span class='st'>"female"</span>))
  <span class='no'>model2</span> <span class='kw'>&lt;-</span> <span class='fu'>ergmito</span>(<span class='no'>fivenets</span> ~ <span class='no'>edges</span> + <span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm-terms.html'>nodematch</a></span>(<span class='st'>"female"</span>) + <span class='no'>mutual</span>)

  <span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/lrtest.html'>lrtest</a></span>(<span class='no'>model1</span>, <span class='no'>model2</span>)
  <span class='co'># Likelihood ratio test</span>
  <span class='co'># </span>
  <span class='co'># Model 1: fivenets ~ edges + nodematch("female") </span>
  <span class='co'># Model 2: fivenets ~ edges + nodematch("female") + mutual</span>
  <span class='co'>#   #Df  LogLik Df  Chisq Pr(&gt;Chisq)</span>
  <span class='co'># 1   2 -34.671                     </span>
  <span class='co'># 2   3 -34.205 1 0.9312     0.3346</span>
}</div><div class='output co'>#&gt; <span class='message'>Loading required package: lmtest</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: zoo</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘zoo’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    as.Date, as.Date.numeric</span></div><div class='output co'>#&gt; <span class='warning'>Warning: The observed statistics (target.statistics) are near or at the boundary of its support, i.e. the Maximum Likelihood Estimates maynot exist or be hard to be estimated. In particular, the statistic(s) "edges", "nodematch.female".</span></div><div class='output co'>#&gt; <span class='warning'>Warning: The observed statistics (target.statistics) are near or at the boundary of its support, i.e. the Maximum Likelihood Estimates maynot exist or be hard to be estimated. In particular, the statistic(s) "edges", "nodematch.female", "mutual".</span></div><div class='output co'>#&gt; Likelihood ratio test
#&gt; 
#&gt; Model 1: fivenets ~ edges + nodematch("female")
#&gt; Model 2: fivenets ~ edges + nodematch("female") + mutual
#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)
#&gt; 1   2 -34.671                     
#&gt; 2   3 -34.205  1 0.9312     0.3346</div><div class='input'>
<span class='co'># Example 4: Adding an reference term for edge-count ----------------------</span>

<span class='co'># Simulating networks of different sizes</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>12344</span>)
<span class='no'>nets</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rbernoulli.html'>rbernoulli</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>4</span>, <span class='fl'>10</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>5</span>, <span class='fl'>10</span>)), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>.2</span>, <span class='fl'>10</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>.1</span>, <span class='fl'>10</span>)))

<span class='co'># Fitting an ergmito under the Bernoulli model</span>
<span class='no'>ans0</span> <span class='kw'>&lt;-</span> <span class='fu'>ergmito</span>(<span class='no'>nets</span> ~ <span class='no'>edges</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: The observed statistics (target.statistics) are near or at the boundary of its support, i.e. the Maximum Likelihood Estimates maynot exist or be hard to be estimated. In particular, the statistic(s) "edges".</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/ergm/man/summary.formula.html'>summary</a></span>(<span class='no'>ans0</span>)</div><div class='output co'>#&gt; 
#&gt; ERGMito estimates (MLE)
#&gt; This model includes 20 networks.
#&gt; 
#&gt; formula:
#&gt;   nets ~ edges
#&gt; &lt;environment: 0x11d8d5a0&gt;
#&gt; 
#&gt;       Estimate Std. Error z value  Pr(&gt;|z|)    
#&gt; edges -1.68640    0.15396 -10.954 &lt; 2.2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; AIC: 279.3753    BIC: 283.1436    (Smaller is better.) </div><div class='input'><span class='co'># </span>
<span class='co'># ERGMito estimates</span>
<span class='co'># </span>
<span class='co'># formula:</span>
<span class='co'>#   nets ~ edges</span>
<span class='co'># </span>
<span class='co'>#       Estimate Std. Error z value  Pr(&gt;|z|)    </span>
<span class='co'># edges -1.68640    0.15396 -10.954 &lt; 2.2e-16 ***</span>
<span class='co'># ---</span>
<span class='co'># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class='co'># AIC: 279.3753    BIC: 283.1436    (Smaller is better.) </span>


<span class='co'># Fitting the model including a reference term for networks of size 5.</span>
<span class='co'># Notice that the variable -n- and other graph attributes can be used</span>
<span class='co'># with -model_update-.</span>
<span class='no'>ans1</span> <span class='kw'>&lt;-</span> <span class='fu'>ergmito</span>(<span class='no'>nets</span> ~ <span class='no'>edges</span>, <span class='kw'>model_update</span> <span class='kw'>=</span> ~ <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span>(<span class='no'>edges</span> * (<span class='no'>n</span> <span class='kw'>==</span> <span class='fl'>5</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: The observed statistics (target.statistics) are near or at the boundary of its support, i.e. the Maximum Likelihood Estimates maynot exist or be hard to be estimated. In particular, the statistic(s) "edges", "I(edges * (n == 5))".</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/ergm/man/summary.formula.html'>summary</a></span>(<span class='no'>ans1</span>)</div><div class='output co'>#&gt; 
#&gt; ERGMito estimates (MLE)
#&gt; This model includes 20 networks.
#&gt; 
#&gt; formula:
#&gt;   nets ~ edges + I(edges * (n == 5))
#&gt; &lt;environment: 0x11d8d5a0&gt;
#&gt; 
#&gt;                     Estimate Std. Error z value  Pr(&gt;|z|)    
#&gt; edges               -1.18958    0.21583 -5.5116 3.556e-08 ***
#&gt; I(edges * (n == 5)) -0.90116    0.31250 -2.8837   0.00393 ** 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; AIC: 272.9916    BIC: 280.5282    (Smaller is better.) </div><div class='input'><span class='co'># </span>
<span class='co'># ERGMito estimates</span>
<span class='co'># </span>
<span class='co'># formula:</span>
<span class='co'>#   nets ~ edges + I(edges * (n == 5))</span>
<span class='co'># </span>
<span class='co'>#                     Estimate Std. Error z value  Pr(&gt;|z|)    </span>
<span class='co'># edges               -1.18958    0.21583 -5.5116 3.556e-08 ***</span>
<span class='co'># I(edges * (n == 5)) -0.90116    0.31250 -2.8837   0.00393 ** </span>
<span class='co'># ---</span>
<span class='co'># Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class='co'># AIC: 272.9916    BIC: 280.5282    (Smaller is better.) </span>

<span class='co'># The resulting parameter for the edge-count is smaller for networks</span>
<span class='co'># of size five</span>
<span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>ans1</span>)[<span class='fl'>1</span>])   <span class='co'># 0.23</span></div><div class='output co'>#&gt;     edges 
#&gt; 0.2333333 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/Logistic.html'>plogis</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/ergm/man/ergm-terms.html'>sum</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>ans1</span>))) <span class='co'># 0.11</span></div><div class='output co'>#&gt; [1] 0.11</div><div class='input'>
<span class='co'># We can see that in this case the difference in edge-count matters.</span>
<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>lmtest</span>)) {

  <span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/lrtest.html'>lrtest</a></span>(<span class='no'>ans0</span>, <span class='no'>ans1</span>)
  <span class='co'># Likelihood ratio test</span>
  <span class='co'># </span>
  <span class='co'># Model 1: nets ~ edges</span>
  <span class='co'># Model 2: nets ~ edges + I(edges * (n == 5))</span>
  <span class='co'># #Df  LogLik Df  Chisq Pr(&gt;Chisq)   </span>
  <span class='co'># 1   1 -138.69                        </span>
  <span class='co'># 2   2 -134.50  1 8.3837   0.003786 **</span>
  <span class='co'>#   ---</span>
  <span class='co'>#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
}</div><div class='output co'>#&gt; Likelihood ratio test
#&gt; 
#&gt; Model 1: nets ~ edges
#&gt; Model 2: nets ~ edges + I(edges * (n == 5))
#&gt;   #Df  LogLik Df  Chisq Pr(&gt;Chisq)   
#&gt; 1   1 -138.69                        
#&gt; 2   2 -134.50  1 8.3837   0.003786 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by George Vega Yon, Army Research Laboratory and the U.S. Army Research Office.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


